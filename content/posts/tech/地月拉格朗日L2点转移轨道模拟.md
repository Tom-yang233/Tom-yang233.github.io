---
title: '地月拉格朗日L2点转移轨道模拟'
author: 杨致远
date: '2026-02-26T18:46:04+08:00'
draft: false
math: true
tags: ["轨道动力学", "深空探测", "GMAT"]
description: "利用GMAT软件对地月拉格朗日L2点转移轨道进行数值模拟与分析。"
---

**杨致远** (PB23000205)

> **摘要**：地月 L2 点位于月球背面，在其附近运行的卫星可以为月球背面和地球之间提供通讯中继。设计从地球出发进入地月 L2 点 Halo 轨道的转移轨道具有较强的实用价值。本文主要关注月球引力辅助变轨转移轨道，利用 GMAT 软件进行了轨道数值模拟，并绘制了相关的轨道示意图及流形分析图。
>
> **关键词**：地月 L2 点；Halo 轨道；月球借力；轨道模拟；GMAT

---

## 1. 引言

由于地球与月球之间的潮汐锁定效应，月球始终只有一面对向地球，导致月球背面的探测器无法直接与地球通信。“嫦娥 4 号”任务实现了人类首次月球背面软着陆探测，而在该任务中，绕地月 L2 点运行的“鹊桥”中继星起到了关键的中继保障作用。“鹊桥”是我国首颗正式任务采用平动点轨道的中继卫星，其轨道设计极为精巧$^{[1]}$。

本文参考其任务设计思路，研究从地球出发、利用月球引力辅助变轨（Lunar Gravity Assist）进入地月 L2 点 Halo 轨道的转移轨道。通过 GMAT (General Mission Analysis Tool) 软件对从近地轨道 (LEO) 到地月 L2 点 Halo 轨道的全过程进行数值模拟。
## 2. 轨道设计方案

通常，从地球到地月 L2 点的转移轨道主要有直接转移、低能转移和月球引力辅助变轨转移三类$^{[2-4]}$。各类轨道的性能对比如表 1 所示：

<div align="center">
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184649_0149793eff2c601898bdc568ab381635.png" width="100%" />
  <br>
  <b>表 1：地月 L2 点转移轨道设计方案对比（引自文 [1]）</b>
</div>

其中，月球引力辅助变轨转移方案是从地球发射至直接地月转移轨道，在飞行至近月点时通过月球借力完成减速与增益变轨。在这种设计下，卫星并不进入环月轨道，而是利用月球引力在飞越后进入地月 L2 点附近的稳定流形，最终只需极小的速度增量 $\Delta v$ 即可捕获入轨。
## 3. 轨道模拟与仿真

本文利用 GMAT 软件对该过程进行建模。

### 3.1 卫星初始状态设置
本次仿真的卫星命名为“月球背面通信卫星”（Moon Far-side Communication Satellite, **MFCSat**）。初始状态设定在高度为 $600 \text{ km}$ 的近地停泊轨道上，其基础参数配置如图 1 所示。

<div align="center">
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184718_bff225d0cc54b63fbd12cc3dca228001.png" width="100%" />
  <br>
  <b>图 1：MFCSat 航天器初始停泊轨道设置参数</b>
</div>
### 3.2 地月转移段模拟
转移轨道分为地月转移和月球至 L2 点转移两段。为了实现月球引力借力，需将近月点设置在靠近地球一侧，并将月球 B 平面瞄准参数的目标设为 $B \cdot T = 6000 \text{ km}$。

通过调整停泊轨道倾角、停泊等待时间以及 TLI 推力参数，利用 GMAT 的差分求解器 (Differential Corrector) 进行迭代，求解出的地月转移段轨道示意图如图 2 所示。

<div align="center">
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184724_9636fd4ff5f0f26a1281a9a8d0a499e3.png" width="100%" />
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184730_40f6b9070b05dd54f12f98346acc2aea.png" width="100%" />
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184735_7460b8b8c1ac4bb333e482ab3c31c979.png" width="100%" />
  <br>
  <b>图 2：地月转移段轨道数值模拟示意图（多视角展示）</b>
</div>

在迭代过程中，由于变量较多，我采用了“步进局部搜索”的方法：先放宽变量约束范围并放大扰动倍数，在确定大致方向后，再手动缩小范围进行精细化迭代计算。
### 3.3 Halo 轨道捕获与流形分析
在飞越月球附近时进行一次轨道机动，改变轨道平面和能量，引导卫星飞向目标 Halo 轨道。轨道捕获控制点的选取需平衡月球背面覆盖率与机动消耗。

<div align="center">
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184744_574607af6525aaaf07cdfe5096537a28.png" width="100%" />
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184749_07b491d3ab1e73f0527e27c70a5824a9.png" width="100%" />
  <br>
  <b>图 3：从月球飞越至地月 L2 点的捕获段轨道示意图</b>
</div>

考虑到 L2 点是不稳定平衡点，必须精确控制捕获点的入轨速度。在入轨捕获点（通常选在 $x$-$z$ 平面上），卫星主要具有 $y$ 方向的速度。通过仿真可以看出，Halo 轨道对初速度极其敏感：速度略大（约 $1 \text{ m/s}$ 级偏差）则会坠向月球，速度略小则会逸出至绕地轨道。这些轨道在相空间中构成的轮廓即为**不变流形**（如图 4 所示）。

<div align="center">
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184755_0d058bf51e52bada0be952d07fb0602c.png" width="100%" />
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184801_570dbbeabf309eadf243f583a544e2a4.png" width="100%" />
  <br>
  <b>图 4：L2 点 Halo 轨道初速度敏感度及不变流形分布图（左图步进 $1 \text{ m/s}$，右图步进 $0.1 \text{ m/s}$）</b>
</div>
通过上述测试，将所得速度数据作为第二次轨道机动的目标值，最终完成了从近地轨道到地月 L2 点 Halo 轨道的完整转移演练，如图 5 所示。

<div align="center">
  <img src="https://barbarian-1306448949.cos.ap-nanjing.myqcloud.com/pic/20260226184808_b291e9125863707ba9df4e4e7c0553a6.png" width="100%" />
  <br>
  <b>图 5：完整的地月 L2 点 Halo 轨道转移示意图（同步旋转坐标系）</b>
</div>

## 4. 结论与总结

本文通过数值仿真方法，模拟了采用月球引力辅助变轨转移方式从低地球轨道向地月 L2 点 Halo 轨道的转移轨道。分析了卫星发射窗口、地月转移时长及 Halo 轨道捕获等关键环节的参数设置。由于地月 L2 点轨道本质上的不稳定性，实际任务中运行在 Halo 轨道上的卫星需要周期性（如每半圈轨道）执行轨道修正$^{[1]}$。本次仿真中尚未加入中长期轨道维持的相关逻辑，且相较于文献中的理论最优解，本方案所需的速度增量 $\Delta v$ 仍有进一步优化的空间。

## 5. 参考文献

[1] 高珊，周文艳，梁伟光，等. 地月拉格朗日L2点中继星轨道分析与设计[J]. 深空探测学报，2017，4（2）：122-129.  
[2] Farqubar R W. The Utilization of halo orbits in advanced lunar operations [R]. Greenbelt, Maryland: Goddard Space Flight Center, 1971.  
[3] Miller J K. Targeting an optimal lunar transfer trajectory using ballistic capture [R]. Pasadena, California: Jet Propulsion Laboratory, California Institute of Technology, 1994.  
[4] Gordon D P. Transfers to Earth-Moon L2 Halo orbits using lunar proximity and invariant manifolds [D]. Indiana: Purdue University, 2008.

---

## 附录：GMAT 仿真脚本

```gmat
%----------------------------------------
% Fliename: mfcsat_eml2.script
% Description: This is a term project of USTC Orbital Dynamics lecture at 25 Spring, taught by Prof.Lei and Prof.Dang. 
%              The script sets up a mission to place a spacecraft in a halo orbit around the Earth-Moon L2 point,
%              including a lunar flyby and a maneuver to achieve the halo orbit.
% Author: yzy PB23000205
% Created: 2025-06-16
% Modified: 2025-06-20
%----------------------------------------

%----------------------------------------
%---------- Lagrange Point
%----------------------------------------

Create LibrationPoint EML2;
GMAT EML2.OrbitColor = GreenYellow;
GMAT EML2.TargetColor = DarkGray;
GMAT EML2.Primary = Earth;
GMAT EML2.Secondary = Luna;
GMAT EML2.Point = L2;

%----------------------------------------
%---------- Spacecraft
%----------------------------------------

Create Spacecraft MFCSat;
GMAT MFCSat.DateFormat = UTCGregorian;
GMAT MFCSat.Epoch = '20 Jun 2025 04:00:00.000';
GMAT MFCSat.CoordinateSystem = EarthMJ2000Eq;

GMAT MFCSat.DisplayStateType = Keplerian;
GMAT MFCSat.SMA = 7000;
GMAT MFCSat.ECC = 0;
GMAT MFCSat.INC = 0;
GMAT MFCSat.RAAN = 0;
GMAT MFCSat.AOP = 0;
GMAT MFCSat.TA = 0;

GMAT MFCSat.DryMass = 800;
GMAT MFCSat.Cd = 2.2;
GMAT MFCSat.Cr = 1.8;
GMAT MFCSat.DragArea = 15;
GMAT MFCSat.SRPArea = 1;
GMAT MFCSat.SPADDragScaleFactor = 1;

GMAT MFCSat.SPADSRPScaleFactor = 1;
GMAT MFCSat.AtmosDensityScaleFactor = 1;
GMAT MFCSat.ExtendedMassPropertiesModel = 'None';
GMAT MFCSat.NAIFId = -10000001;
GMAT MFCSat.NAIFIdReferenceFrame = -9000001;
GMAT MFCSat.OrbitColor = Red;
GMAT MFCSat.TargetColor = Teal;
GMAT MFCSat.OrbitErrorCovariance = [ 1e+70 0 0 0 0 0 ; 0 1e+70 0 0 0 0 ; 0 0 1e+70 0 0 0 ; 0 0 0 1e+70 0 0 ; 0 0 0 0 1e+70 0 ; 0 0 0 0 0 1e+70 ];
GMAT MFCSat.CdSigma = 1e+70;
GMAT MFCSat.CrSigma = 1e+70;
GMAT MFCSat.Id = 'SatId';
GMAT MFCSat.Attitude = CoordinateSystemFixed;
GMAT MFCSat.SPADSRPInterpolationMethod = Bilinear;
GMAT MFCSat.SPADSRPScaleFactorSigma = 1e+70;
GMAT MFCSat.SPADDragInterpolationMethod = Bilinear;
GMAT MFCSat.SPADDragScaleFactorSigma = 1e+70;
GMAT MFCSat.AtmosDensityScaleFactorSigma = 1e+70;

GMAT MFCSat.ModelFile = 'aura.3ds';
GMAT MFCSat.ModelOffsetX = 0;
GMAT MFCSat.ModelOffsetY = 0;
GMAT MFCSat.ModelOffsetZ = 0;
GMAT MFCSat.ModelRotationX = 0;
GMAT MFCSat.ModelRotationY = 0;
GMAT MFCSat.ModelRotationZ = 0;
GMAT MFCSat.ModelScale = 1;
GMAT MFCSat.AttitudeDisplayStateType = 'Quaternion';
GMAT MFCSat.AttitudeRateDisplayStateType = 'AngularVelocity';
GMAT MFCSat.AttitudeCoordinateSystem = EarthMJ2000Eq;
GMAT MFCSat.EulerAngleSequence = '321';

%----------------------------------------
%---------- ForceModels
%----------------------------------------

Create ForceModel EMProp_ForceModel;
GMAT EMProp_ForceModel.CentralBody = Earth;
GMAT EMProp_ForceModel.PointMasses = {Earth, Luna, Sun};
GMAT EMProp_ForceModel.Drag = None;
GMAT EMProp_ForceModel.SRP = On;
GMAT EMProp_ForceModel.RelativisticCorrection = Off;
GMAT EMProp_ForceModel.ErrorControl = RSSStep;
GMAT EMProp_ForceModel.SRP.Flux = 1367;
GMAT EMProp_ForceModel.SRP.SRPModel = Spherical;
GMAT EMProp_ForceModel.SRP.Nominal_Sun = 149597870.691;

%----------------------------------------
%---------- Propagators
%----------------------------------------

Create Propagator EMProp;
GMAT EMProp.FM = EMProp_ForceModel;
GMAT EMProp.Type = PrinceDormand78;
GMAT EMProp.InitialStepSize = 600;
GMAT EMProp.Accuracy = 1e-13;
GMAT EMProp.MinStep = 0;
GMAT EMProp.MaxStep = 86400;
GMAT EMProp.MaxStepAttempts = 50;
GMAT EMProp.StopIfAccuracyIsViolated = true;

%----------------------------------------
%---------- Burns
%----------------------------------------

Create ImpulsiveBurn TLI;
GMAT TLI.CoordinateSystem = Local;
GMAT TLI.Origin = Earth;
GMAT TLI.Axes = VNB;
GMAT TLI.Element1 = 0;
GMAT TLI.Element2 = 0;
GMAT TLI.Element3 = 0;
GMAT TLI.DecrementMass = false;
GMAT TLI.Isp = 300;
GMAT TLI.GravitationalAccel = 9.81;

Create ImpulsiveBurn DSM1;
GMAT DSM1.CoordinateSystem = EML2xyz;
GMAT DSM1.Element1 = 0;
GMAT DSM1.Element2 = 0;
GMAT DSM1.Element3 = 0;
GMAT DSM1.DecrementMass = false;
GMAT DSM1.Isp = 300;
GMAT DSM1.GravitationalAccel = 9.81;

%----------------------------------------
%---------- Coordinate Systems
%----------------------------------------

Create CoordinateSystem moonxyz;
GMAT moonxyz.Origin = Luna;
GMAT moonxyz.Axes = ObjectReferenced;
GMAT moonxyz.XAxis = R;
GMAT moonxyz.ZAxis = N;
GMAT moonxyz.Primary = Earth;
GMAT moonxyz.Secondary = Luna;

Create CoordinateSystem EML2xyz;
GMAT EML2xyz.Origin = EML2;
GMAT EML2xyz.Axes = ObjectReferenced;
GMAT EML2xyz.XAxis = R;
GMAT EML2xyz.ZAxis = N;
GMAT EML2xyz.Primary = Earth;
GMAT EML2xyz.Secondary = Luna;

%----------------------------------------
%---------- Solvers
%----------------------------------------

Create DifferentialCorrector DefaultDC;
GMAT DefaultDC.ShowProgress = true;
GMAT DefaultDC.ReportStyle = Normal;
GMAT DefaultDC.ReportFile = 'DifferentialCorrectorDefaultDC.data';
GMAT DefaultDC.MaximumIterations = 25;
GMAT DefaultDC.DerivativeMethod = ForwardDifference;
GMAT DefaultDC.Algorithm = NewtonRaphson;

%----------------------------------------
%---------- Subscribers
%----------------------------------------

Create OrbitView EML2View;
GMAT EML2View.SolverIterations = Current;
GMAT EML2View.UpperLeft = [ 0.01156626506024096 0.3572854291417166 ];
GMAT EML2View.Size = [ 0.291566265060241 0.5668662674650699 ];
GMAT EML2View.RelativeZOrder = 509;
GMAT EML2View.Maximized = false;
GMAT EML2View.Add = {MFCSat, EML2, Luna, Earth};
GMAT EML2View.CoordinateSystem = EML2xyz;
GMAT EML2View.DrawObject = [ true true true true ];
GMAT EML2View.DataCollectFrequency = 1;
GMAT EML2View.UpdatePlotFrequency = 50;
GMAT EML2View.NumPointsToRedraw = 0;
GMAT EML2View.ShowPlot = true;
GMAT EML2View.MaxPlotPoints = 60000;
GMAT EML2View.ShowLabels = true;
GMAT EML2View.ViewPointReference = EML2;
GMAT EML2View.ViewPointVector = [ 110000 -10000 30000 ];
GMAT EML2View.ViewDirection = EML2;
GMAT EML2View.ViewScaleFactor = 1;
GMAT EML2View.ViewUpCoordinateSystem = EML2xyz;
GMAT EML2View.ViewUpAxis = Z;
GMAT EML2View.EclipticPlane = Off;
GMAT EML2View.XYPlane = On;
GMAT EML2View.WireFrame = Off;
GMAT EML2View.Axes = On;
GMAT EML2View.Grid = Off;
GMAT EML2View.SunLine = Off;
GMAT EML2View.UseInitialView = On;
GMAT EML2View.StarCount = 7000;
GMAT EML2View.EnableStars = Off;
GMAT EML2View.EnableConstellations = Off;

Create OrbitView MoonView;
GMAT MoonView.SolverIterations = Current;
GMAT MoonView.UpperLeft = [ 0.6139759036144579 0.3562874251497006 ];
GMAT MoonView.Size = [ 0.2934939759036145 0.5658682634730539 ];
GMAT MoonView.RelativeZOrder = 504;
GMAT MoonView.Maximized = false;
GMAT MoonView.Add = {MFCSat, Earth, EML2, Luna};
GMAT MoonView.CoordinateSystem = moonxyz;
GMAT MoonView.DrawObject = [ true true true true ];
GMAT MoonView.DataCollectFrequency = 1;
GMAT MoonView.UpdatePlotFrequency = 50;
GMAT MoonView.NumPointsToRedraw = 0;
GMAT MoonView.ShowPlot = true;
GMAT MoonView.MaxPlotPoints = 60000;
GMAT MoonView.ShowLabels = true;
GMAT MoonView.ViewPointReference = Luna;
GMAT MoonView.ViewPointVector = [ 0 0 13000 ];
GMAT MoonView.ViewDirection = Luna;
GMAT MoonView.ViewScaleFactor = 1;
GMAT MoonView.ViewUpCoordinateSystem = moonxyz;
GMAT MoonView.ViewUpAxis = Z;
GMAT MoonView.EclipticPlane = Off;
GMAT MoonView.XYPlane = On;
GMAT MoonView.WireFrame = Off;
GMAT MoonView.Axes = On;
GMAT MoonView.Grid = Off;
GMAT MoonView.SunLine = Off;
GMAT MoonView.UseInitialView = On;
GMAT MoonView.StarCount = 7000;
GMAT MoonView.EnableStars = Off;
GMAT MoonView.EnableConstellations = Off;

Create OrbitView EarthView;
GMAT EarthView.SolverIterations = Current;
GMAT EarthView.UpperLeft = [ 0.3084337349397591 0.3572854291417166 ];
GMAT EarthView.Size = [ 0.2973493975903614 0.5658682634730539 ];
GMAT EarthView.RelativeZOrder = 522;
GMAT EarthView.Maximized = false;
GMAT EarthView.Add = {MFCSat, Earth, EML2, Luna};
GMAT EarthView.CoordinateSystem = EarthMJ2000Eq;
GMAT EarthView.DrawObject = [ true true true true ];
GMAT EarthView.DataCollectFrequency = 1;
GMAT EarthView.UpdatePlotFrequency = 50;
GMAT EarthView.NumPointsToRedraw = 0;
GMAT EarthView.ShowPlot = true;
GMAT EarthView.MaxPlotPoints = 20000;
GMAT EarthView.ShowLabels = true;
GMAT EarthView.ViewPointReference = Earth;
GMAT EarthView.ViewPointVector = [ 0 0 300000 ];
GMAT EarthView.ViewDirection = Earth;
GMAT EarthView.ViewScaleFactor = 1;
GMAT EarthView.ViewUpCoordinateSystem = EarthMJ2000Eq;
GMAT EarthView.ViewUpAxis = Z;
GMAT EarthView.EclipticPlane = Off;
GMAT EarthView.XYPlane = On;
GMAT EarthView.WireFrame = Off;
GMAT EarthView.Axes = On;
GMAT EarthView.Grid = Off;
GMAT EarthView.SunLine = Off;
GMAT EarthView.UseInitialView = On;
GMAT EarthView.StarCount = 7000;
GMAT EarthView.EnableStars = Off;
GMAT EarthView.EnableConstellations = Off;

%----------------------------------------
%---------- Arrays, Variables, Strings
%----------------------------------------
Create Variable wait_time;
GMAT wait_time = 0;

%----------------------------------------
%---------- Mission Sequence
%----------------------------------------

BeginMissionSequence;

Target 'to Moon' DefaultDC {SolveMode = Solve, ExitMode = SaveAndContinue, ShowProgressWindow = true};
   Vary 'Vary INC' DefaultDC(MFCSat.INC = 28.2181963915, {Perturbation = 0.0001, Lower = 20, Upper = 40, MaxStep = 10, AdditiveScaleFactor = 0.0, MultiplicativeScaleFactor = 5.0});
   Vary 'Vary wait_time' DefaultDC(wait_time = 3.90185069579, {Perturbation = 0.0001, Lower = 2, Upper = 5, MaxStep = 1, AdditiveScaleFactor = 0.0, MultiplicativeScaleFactor = 1.0});
   Propagate 'wait on LEO' EMProp(MFCSat) {MFCSat.ElapsedDays = wait_time};
   Vary 'Vary TLI.v' DefaultDC(TLI.Element1 = 3.04782634848, {Perturbation = 0.0001, Lower = 0, Upper = 10, MaxStep = 0.01, AdditiveScaleFactor = 0.0, MultiplicativeScaleFactor = 1.0});
   Vary 'Vary TLI.n' DefaultDC(TLI.Element2 = -0.0513571095359, {Perturbation = 0.0001, Lower = -1, Upper = 1, MaxStep = 0.01, AdditiveScaleFactor = 0.0, MultiplicativeScaleFactor = 1.0});
   Maneuver 'Apply TLI' TLI(MFCSat);
   Propagate 'prop to moon pe' EMProp(MFCSat) {MFCSat.Luna.Periapsis};
   Achieve 'Achieve moonxyz.BdotT = 6000' DefaultDC(MFCSat.moonxyz.BdotT = 6000, {Tolerance = 0.1});
EndTarget;  % For targeter DefaultDC

Target 'to Halo Orbit' DefaultDC {SolveMode = Solve, ExitMode = SaveAndContinue, ShowProgressWindow = true};
   Vary 'Vary DSM1.v' DefaultDC(DSM1.Element1 = 0.0551140585905, {Perturbation = 0.0001, Lower = -10, Upper = 10, MaxStep = 0.2, AdditiveScaleFactor = 0.0, MultiplicativeScaleFactor = 1.0});
   Vary 'Vary DSM1.n' DefaultDC(DSM1.Element2 = -0.0202258831964, {Perturbation = 0.0001, Lower = -10, Upper = 10, MaxStep = 0.2, AdditiveScaleFactor = 0.0, MultiplicativeScaleFactor = 1.0});
   Vary 'Vary DSM1.b' DefaultDC(DSM1.Element3 = 0.911207216998, {Perturbation = 0.0001, Lower = -10, Upper = 10, MaxStep = 0.2, AdditiveScaleFactor = 0.0, MultiplicativeScaleFactor = 1.0});
   Maneuver 'Apply DSM1' DSM1(MFCSat);
   Propagate 'Prop to Halo Orbit inject point' EMProp(MFCSat) {MFCSat.EML2xyz.X = 9000};
   Achieve DefaultDC(MFCSat.EML2xyz.Y = 0, {Tolerance = 0.01});
   Achieve DefaultDC(MFCSat.EML2xyz.Z = 20000.0, {Tolerance = 0.01});
EndTarget;  % For targeter DefaultDC

BeginScript 'Apply DSM2'
   GMAT MFCSat.CoordinateSystem = EML2xyz;
   GMAT MFCSat.VX = 0;
   GMAT MFCSat.VY = -0.1871
   GMAT MFCSat.VZ = 0;
EndScript;

Propagate 'Prop 28 days' EMProp(MFCSat) {MFCSat.ElapsedDays = 28};
```

